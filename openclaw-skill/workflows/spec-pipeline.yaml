id: spec-pipeline
name: Spec Pipeline — Requirements to Specification
description: Transform informal requirements into executable specifications

phases:
  - id: gather
    agent: pm
    task: Collect and structure requirements (functional, non-functional, constraints).
    output: .agdev/handoff/requirements.json

  - id: assess
    agent: architect
    task: Evaluate complexity (scope, integration, infrastructure, knowledge, risk). Classify as SIMPLE/STANDARD/COMPLEX.
    input: .agdev/handoff/requirements.json
    output: .agdev/handoff/complexity.json

  - id: research
    agent: analyst
    condition: complexity is not SIMPLE
    task: Research dependencies, validate technologies, gather implementation patterns.
    input: .agdev/handoff/requirements.json
    output: .agdev/handoff/research.json

  - id: spec
    agent: pm
    task: Write complete specification from all artifacts. No invention — only derive from inputs.
    input: all previous outputs
    output: .agdev/handoff/spec.md

  - id: critique
    agent: qa
    task: |
      Validate spec against requirements.
      Verdict: APPROVED / NEEDS_REVISION / BLOCKED.
    input: .agdev/handoff/spec.md + requirements
    output: .agdev/handoff/critique.json

  - id: revise
    agent: pm
    condition: NEEDS_REVISION (max 2 iterations)
    task: Apply critique feedback to improve spec.
    input: .agdev/handoff/critique.json
    output: .agdev/handoff/spec.md (updated)
